[workspace]
name = "try_pixi_cpp"
version = "0.1.0"
description = "Demo: Pixi C++ dependency management with zstd wrapper"
channels = ["conda-forge"]
platforms = ["linux-64", "osx-64", "osx-arm64", "win-64"]

[dependencies]
cmake = ">=3.20"
ninja = ">=1.11"
zstd = ">=1.5"

[feature.build.dependencies]
cxx-compiler = ">=1.5"

[environments]
default = { features = ["build"], solve-group = "default" }

[tasks]
configure-wrapper = { cmd = "cmake -GNinja -S zstd_wrapper -B build/wrapper -DCMAKE_INSTALL_PREFIX=$CONDA_PREFIX -DCMAKE_CXX_STANDARD=20" }
build-wrapper = { cmd = "cmake --build build/wrapper && cmake --install build/wrapper", depends-on = ["configure-wrapper"] }
configure-app = { cmd = "cmake -GNinja -S zstd_app -B build/app -DCMAKE_PREFIX_PATH=$CONDA_PREFIX -DCMAKE_CXX_STANDARD=20", depends-on = ["build-wrapper"] }
build-app = { cmd = "cmake --build build/app", depends-on = ["configure-app"] }
build = { depends-on = ["build-app"] }
run = { cmd = "build/app/zstd_app", depends-on = ["build-app"] }
clean = { cmd = "rm -rf build" }
